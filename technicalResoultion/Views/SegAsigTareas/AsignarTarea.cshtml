@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewBag.Title = "ASIGNAR TAREA";
}

<script>
    function addTarea()
    {
        var tarea = document.querySelector("#tarea").value;
        var encargado = document.querySelector("#encargado").value;

        var area = document.querySelector("#tare_area");
        
        if (encargado > 0)
        {
            area.append(tarea + "," + encargado + ";");
        }
    }
    // function ticketSeleccionado() {
    //     var i = 1;
    //     var it = 4;
    // while (true)
    // {
    // document.getElementById("seleccionar_" + i).addEventListener("click",
    //     function () {
    //         var ticket = document.getElementById("id_ticket_area_" + i).value;
    //         document.querySelector("#id_ticket").value = ticket;
    //         break;
    //     });

    // if (document.getElementById("seleccionar_" + i).onclick == true)
    // {
    //     var ticket = document.getElementById("id_ticket_area_" + i).value;
    //     document.querySelector("#id_ticket").value = ticket;
    //     break;
    // }

    // const boton = document.querySelector("#botonSeleccionar");

    // boton.addEventListener("click",
    //     function() {
    //         var celda = document.getElementsByTagName("th");
    //         var ticket = celda[4].innerHTML;
    //         document.querySelector("#id_ticket").value = ticket;
    //         break;
    //     }
    // );

    // if (document.getElementById("seleccionar_" + i).onclick == true) {
    //     var celda = document.getElementsByTagName("th");
    //     var ticket = celda[it].innerHTML;
    //     document.querySelector("#id_ticket").value = ticket;
    //     break;
    // }

    // var boton = document.getElementById('seleccionar_1');

    // boton.addEventListener('click', function () {
    //     var celda = document.getElementsByTagName("th");
    //     var ticket = celda[it].innerHTML;
    //     document.querySelector("#id_ticket").value = ticket;
    // });

    //     i++;
    //     it++;
    // }
    // }
</script>

<div class="container mt-5 d-flex">
    <div class="ms-5 ">
        <div class="cabecera d-flex justify-content-between ">
            <div class="titulo">
                <h2 class="fw-bold">Tickets no asignados</h2>
            </div>
            <div class="botones d-flex ">
                <div>
                    <span>Filtrar por:</span>
                    <select name="" id="" class="form-control">
                        <option selected>Prioridad</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="tabla mt-4">
            <table class="table table-striped ">
                <thead>
                    <tr class="table-dark">
                        <th scope="col" style="width: 8vw; padding-left: 1.5vw;">N° TICKET</th>
                        <th scope="col" style="width: 15vw;">NOMBRE</th>
                        <th scope="col">PRIORIDAD</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    @{var iter = 1;}
                    @foreach (var item in ViewBag.Tickets)
                    {
                        @if (@item.progreso == "En Espera")
                        {

                            <tr>
                                <th scope="row" style="padding-left: 1.5vw;">@item.id</th>
                                <td>@item.nombre</td>
                                <td>@item.prioridad</td>
                                <td><a href="#" id="seleccionar_@iter" onclick="ticketSeleccionado()">Seleccionar</a></td>
                            </tr>
                            { iter++; }
                        }
                    }
                </tbody>
            </table>
        </div>
    </div>

    <div class="ms-5 w-50 " style="margin-top: 5.7vw;">
        <form asp-action="CreateTarea" method="post">
            <div>
                <input type="text" class="form-control " placeholder="Número de Ticket" id="id_ticket" name="id_ticket" value="4" readonly>
            </div>
            <div class="mt-2 ">
                <input type="text" class="form-control " placeholder="Tarea" id="tarea">
            </div>
            <div class="mt-2 ">
                <select class="form-control " name="encargado" id="encargado">
                    <option selected>Se le asigna a...</option>
                    @foreach(var item in ViewBag.Internos)
                    {
                        <option value="@item.id">@item.nombres @item.apellidos - @item.rol</option>
                    }
                </select>
            </div>
            <div class="mt-2 ">
                <a href="#" class="ms-3 " onclick="addTarea()">Añadir tarea</a>
            </div>
            <div class="mt-2 ">
                <a href="#" class="form-control ">Ver tarea añadidas</a>

                <textarea class="form-control" id="tare_area" name="tare_area" readonly></textarea>
            </div>
            <div class="mt-2 ">
                <input type="submit" class="btn btn-primary " value="Añadir tareas">
            </div>
        </form>
    </div>
</div>

<div class="btnVolver d-flex position-fixed bottom-0 p-3 ">
    <a href="./SeguimientoAsignacionTareas.html" class="form-control bg-black text-light text-decoration-none ">Volver</a>
</div>